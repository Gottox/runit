<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<title>runit - use dietlibc</title>
</head>
<body>
<a href="http://smarden.org/pape/">G. Pape</a><br>
<a href="index.html">runit</a><br>
<hr>
<h1>runit - use dietlibc</h1>
<hr>
Check that you have the recent version of
<a href="http://www.fefe.de/dietlibc/">dietlibc</a> installed.
<p>
Change to the source directory of <i>runit</i> and modify the Makefile to
use <tt>diet</tt>:
<pre>
  # cd /package/admin/runit/src
  # vi Makefile
</pre>
Modify the <tt>CC</tt> and <tt>LDFLAGS</tt> variables in the
<tt>Makefile</tt> to these settings:
<pre>
  CC=diet gcc
  LDFLAGS=-Wall -O3 -s -Os -pipe
</pre>
Download
<a href="http://smarden.org/pape/djb/manpages/daemontools-pd-0.76.tar.gz">
daemontools-pd-0.76.tar.gz</a>
into <tt>/package/admin/runit/src</tt> and unpack the archive (this
contains code from the daemontools-0.76 package which are in the Public
domain):
<pre>
  # gunzip daemontools-pd-0.76.tar
  # tar -xpf daemontools-pd-0.76.tar
  # rm daemontools-pd-0.76.tar
</pre>
Tell <i>runit</i> to use this archive instead of the <i>daemontools</i>
sources:
<pre>
  # rm -f support
  # ln -s daemontools-pd-0.76 support
</pre>
Change the <tt>cc</tt> and <tt>ld</tt> settings for
<tt>support</tt> to use <tt>diet</tt>:
<pre>
  # echo 'diet gcc -O2 -Wall' &gt; support/conf-cc
  # echo 'diet gcc -s -Os -pipe' &gt; support/conf-ld
</pre>
Finally rebuild and install the <i>runit</i> programs:
<pre>
  # make clean
  # cd ..
  # package/install
</pre>
<hr>
<address><a href="mailto:pape@smarden.org">
Gerrit Pape &lt;pape@smarden.org&gt;
</a></address>
<small>$Id$</small>
</body>
</html>
